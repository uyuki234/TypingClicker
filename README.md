# TypingBusinessEnglish

タイピングを通じてビジネス英語力を向上させよう

<img width="1552" height="780" alt="スクリーンショット 2026-01-28 23 04 13" src="https://github.com/user-attachments/assets/f28cc96d-4cc8-4019-963f-b3a17df82ca0" />

<img width="1552" height="780" alt="スクリーンショット 2026-01-28 23 04 59" src="https://github.com/user-attachments/assets/aa3a24a0-acae-458c-95ba-1dcf38e47d97" />


## ゲームの概要

**TypingBusinessEnglish** は、ビジネス英語のフレーズをタイピングすることで、英語力とタイピングスキルを同時に向上させる学習ゲームです。

### ゲームの目的

- ビジネス英語のフレーズをタイピングして英語力を向上
- 獲得した English Power でアップグレードを購入し、より効率的に学習を進める
- 実践的なビジネス英語表現を習得しながらレベルアップを目指す

## 実行方法

### 必要環境

- Python 3.10 以上
- pygame ライブラリ
- 解像度 1440 × 640 以上

### 環境構築

```bash
# 仮想環境の作成（推奨）
python3 -m venv venv
source venv/bin/activate  # macOS/Linuxの場合
# または Windows: venv\Scripts\activate

# パッケージのインストール
pip install -r requirements.txt
```

### 起動

```bash
# 仮想環境をアクティベート
source venv/bin/activate  # macOS/Linuxの場合
# または Windows: venv\Scripts\activate

# ゲームの実行
python3 main.py
```

### 仮想環境の終了

```bash
# 仮想環境を終了（非アクティベート）
deactivate
```

### 主な機能

- **3 種類のアップグレード**
  - **Typing Skill**: タイピング 1 回あたりの獲得量を増やす
  - **Auto Typing**: 毎秒自動で English Power を獲得
  - **CPU**: すべての獲得量に倍率をかける（購入時に大幅パワーアップ）
- **レベルシステム**: 獲得した English Power に応じて XP が貯まり、レベルアップ（進捗バーで確認可能）
- **セーブ機能**: ゲーム終了時に自動保存、次回起動時に復元

## 操作方法

### 基本操作

- **タイピング**: 表示される英文をタイピングして English Power を獲得
- **マウス左クリック**: タイピングが苦手でも、画面左側のキーボード画像をクリックして English Power を獲得できる
- **ESC キー**: ゲームを終了

### アップグレードの購入

画面右側に 3 つのアップグレードボタンが表示されます。各ボタンをクリックすると、必要なコストを支払ってレベルアップします。

1. **Typing Skill** (上段)

   - 効果: タイピング 1 回の獲得量 +1

2. **Auto Typing** (中段)

   - 効果: 毎秒の自動獲得量 +2

3. **CPU** (下段)
   - 効果: すべての獲得量を 1.5 倍に（累積）

### 画面の見方

- **左上**: 現在の English Power（英語力）
- **左中央**: 英文と日本語訳（ビジネス英語）
- **左下**: レベル進捗バー（現在のレベル、次のレベルまでに必要な XP）
- **右側**: アップグレード一覧（名前、効果、レベル、購入コスト）

## 工夫した点

### UI デザイン

- **左右分割レイアウト**: クリック操作エリアとアップグレード選択エリアを明確に分離し、視認性を向上
- **アイコン画像の活用**: 各アップグレードに視覚的にわかりやすいアイコンを配置
- **リアルタイム更新**: 現在の効果量を常に表示し、成長を実感できる UI
- **日本語フォント対応**: Noto Sans JP フォントを使用し、日本語表示を美しく実現

### ゲームバランス

- **飽きないレベルデザイン**:
  1. 序盤: Typing Skill を連続購入して即座の成長感
  2. 中盤: Auto Typing で放置でも増える安定感
  3. 終盤: CPU で一気に倍率アップの爽快感
- **指数関数的コスト設定**: レベルが上がるほど購入コストが急増し、長期的なやり込み要素を実現
- **レベルシステム**: 獲得した English Power に応じて XP が貯まり、プレイヤーの成長を可視化

### コード設計

- **モジュール分離**: UI コンポーネント（Button、Counter、TypingDisplay、UIRenderer）を独立したモジュールとして実装
- **状態管理の一元化**: GameState クラスでゲーム状態を管理し、セーブ/ロードを実装
- **ビジネスロジックの分離**: GameLogic クラスで計算ロジックを分離し、テストと保守性を向上
- **設定の外部化**: Config クラスで定数を一元管理し、調整を容易に
- **高いコード品質**: Pylint スコア 9.65/10、循環的複雑度 10 以下、関数の長さ 50 行以下を維持

## 苦労した点

### レイアウト調整

- 画像とテキストの配置を統一するため、最大画像幅を基準にラベルの X 座標を揃える処理が複雑になった
- 右パネルの 3 つのアップグレードボックスを均等に配置し、画像とテキストを整列させる処理
  - ひたすら微調整した

### レベルシステムの実装

- XP の累積計算とレベルアップ判定のロジックで、複数レベル同時アップに対応する必要があった
- レベル進捗バーとパーセンテージの表示

### 自動加算の実装

- クリックと自動加算の両方で XP を正しく加算し、表示を同期する処理
- ゲームを一時停止しても経過時間が正しく処理されるようにする仕組み

### 倍率システムの適用

- クリック力と毎秒力の両方に CPU 倍率を適用する派生計算の設計
- 購入後に即座に効果が反映されるよう、各所で最新の倍率を再計算する必要があった
- 複数のアップグレードに関する計算フローの管理

### タイピング機能の実装

- 英文と日本語訳を同時に表示し、入力進捗を視覚的にわかりやすく表現
- 文字単位での入力判定と、完了時の次の文章への自動遷移
- ランダムな文章選択と、文章データの管理

## ライセンス

このプロジェクトは学習目的で作成されました。

## コード品質測定ツール

### Pylint
#### pygame モジュールの E1101 検知について

pygame モジュールを使用する際、Pylint が `E1101: Module 'pygame' has no 'XXX' member` という検知を報告します。

**検知の理由:**

1. **動的な属性生成**: pygame は C 言語で実装されており、多くの定数やメソッドが実行時に動的に生成されます
2. **静的解析の限界**: Pylint は静的解析ツールであり、実行時に生成される属性を検出できません
3. **具体例**:
   - `pygame.init()`, `pygame.quit()` - 初期化・終了メソッド
   - `pygame.QUIT`, `pygame.MOUSEBUTTONDOWN`, `pygame.KEYDOWN` - イベント定数
   - `pygame.K_ESCAPE` - キーボード定数

**対応方法:**

これらは実際には存在する属性であり、プログラムは正常に動作します。

**参考情報:**

E1101 は、オブジェクトにそのようなメンバーはないよ、というエラーです。動的に変数にオブジェクトを割り当てる場合、変数がどのようなメンバーを持つのかは pylint は判らないので E1101 を出します。しかし、Python では変数に動的にオブジェクトを割り当てるのは当たり前なのでメッセージが山ほど出ます。

引用：https://qiita.com/stat/items/eb74bb26190759f87a05#e1101-%E3%82%A8%E3%83%A9%E3%83%BC

## 使用素材について

- **イラスト**: 生成 AI を利用して作成
- **フォント**: Noto Sans Japanese を使用

## トラブルシューティング

### pygame.font.Font が見つからないエラー

**エラーメッセージ例:**
```
NotImplementedError: font module not available (ImportError: cannot import name 'Font' from partially initialized module 'pygame.font' ...)
```

**原因:**
このエラーは主に以下の場合に発生します：
1. **pygame の破損したインストール**: インストール中に不完全になった可能性
2. **環境の問題**: SDL2 がシステムに正しくインストールされていない
3. **Python バージョンの互換性**: 非常に新しい Python バージョン（3.14 など）で稀に発生

**解決方法:**

1. **Pythonのバージョンを下げる**  
Pygameは最新版のPythonに非対応である場合があるので、エラーが解消されない場合はPythonのバージョンを下げてみてください。
バージョンを下げることでエラーが解消されることがあります。  
私の環境では起きませんでしたが、Python3.11で動作した例があります。

3. **仮想環境を再構築する（最も確実）**
   ```bash
   # 既存の仮想環境を削除
   rm -rf venv
   
   # 新しい仮想環境を作成
   python3 -m venv venv
   source venv/bin/activate  # macOS/Linuxの場合
   
   # パッケージを再インストール
   pip install --upgrade pip
   pip install -r requirements.txt
   ```

4. **pygame を再インストール**
   ```bash
   pip uninstall pygame
   pip install pygame==2.6.1 --force-reinstall --no-cache-dir
   ```

5. **SDL2 がインストールされていることを確認（macOS の場合）**
   ```bash
   # Homebrewを使用している場合
   brew install sdl2
   ```

**テスト済み環境:**
- Python 3.14.2
- pygame 2.6.1
- SDL 2.32.10

**確認状況:**
- ✓ 現在の環境では正常に動作
- 環境差による一時的な問題の可能性が高い
